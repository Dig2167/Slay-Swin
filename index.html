<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slay Sving - –ò—Ç–æ–≥–∏ –ì–æ–¥–∞ 2026</title>
        <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Montserrat', sans-serif;
        }

        body {
            background: #050510;
            min-height: 100vh;
            overflow-x: hidden;
        }

        canvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: -1;
            pointer-events: none;
        }

        .content-overlay {
            position: relative;
            z-index: 1;
        }

        /* Keep the original gradient as fallback */
        .gradient-fallback {
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3a 50%, #2d1b69 100%);
            background-size: 400% 400%;
            animation: gradientBG 20s ease infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .glow-text {
            text-shadow: 0 0 10px #ff006e, 0 0 20px #ff006e, 0 0 40px #ff006e;
        }
        
        .glow-purple {
            text-shadow: 0 0 10px #8338ec, 0 0 20px #8338ec, 0 0 40px #8338ec;
        }
        
        .gradient-border {
            background: linear-gradient(135deg, #ff006e, #8338ec, #3a86ff);
            padding: 3px;
            border-radius: 24px;
        }
        
        .gradient-btn {
            background: linear-gradient(135deg, #ff006e, #8338ec);
            transition: all 0.3s ease;
        }
        
        .gradient-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #8338ec, #ff006e);
            box-shadow: 0 0 30px rgba(255, 0, 110, 0.6);
            transform: scale(1.05);
        }
        
        .gradient-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .select-btn {
            background: linear-gradient(135deg, rgba(255, 0, 110, 0.2), rgba(131, 56, 236, 0.2));
            border: 2px solid rgba(255, 0, 110, 0.5);
            transition: all 0.3s ease;
        }
        
        .select-btn:hover {
            background: linear-gradient(135deg, rgba(255, 0, 110, 0.4), rgba(131, 56, 236, 0.4));
            border-color: #ff006e;
            box-shadow: 0 0 20px rgba(255, 0, 110, 0.4);
        }
        
        .select-btn.voted {
            background: linear-gradient(135deg, rgba(0, 245, 160, 0.2), rgba(0, 217, 245, 0.2));
            border-color: #00f5a0;
        }
        
        .nominee-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .nominee-card:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 0, 110, 0.5);
            transform: translateY(-3px);
        }
        
        .nominee-card.selected {
            border-color: #ff006e;
            background: rgba(255, 0, 110, 0.2);
            box-shadow: 0 0 30px rgba(255, 0, 110, 0.4);
        }
        
        .avatar-img {
            width: 100px;
            height: 100px;
            border-radius: 0;
            object-fit: cover;
            border: 3px solid transparent;
            background: linear-gradient(135deg, #ff006e, #8338ec) border-box;
            transition: all 0.3s ease;
        }
        
        .avatar-placeholder {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff006e, #8338ec);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            font-weight: bold;
            color: white;
            transition: all 0.3s ease;
        }
        
        .floating {
            animation: floating 3s ease-in-out infinite;
        }
        
        @keyframes floating {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        
        .pulse-glow {
            animation: pulseGlow 2s ease-in-out infinite;
        }

        .avatar-glow {
            box-shadow: 0 0 15px rgba(255, 0, 110, 0.4), 0 0 10px rgba(131, 56, 236, 0.3);
        }

        .avatar-glow:hover {
            box-shadow: 0 0 25px rgba(255, 0, 110, 0.6), 0 0 15px rgba(131, 56, 236, 0.4);
            transform: scale(1.05);
        }
        
        @keyframes pulseGlow {
            0%, 100% { box-shadow: 0 0 15px rgba(255, 0, 110, 0.4); }
            50% { box-shadow: 0 0 30px rgba(255, 0, 110, 0.8), 0 0 45px rgba(131, 56, 236, 0.6); }
        }
        
        .nominees-container {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out, opacity 0.3s ease;
            opacity: 0;
        }

        .nominees-container.open {
            max-height: 1000px;
            opacity: 1;
            padding-top: 1.5rem;
        }

        /* Modal Overlay */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .nominee-modal {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255, 0, 110, 0.3);
            border-radius: 24px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.9);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .modal-overlay.active .nominee-modal {
            transform: scale(1);
            opacity: 1;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            position: sticky;
            top: 0;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 2px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .confetti {
            position: fixed;
            pointer-events: none;
            z-index: 1000;
        }
        
        .star {
            position: absolute;
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            animation: twinkle 2s ease-in-out infinite;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }
        
        .category-card {
            background: transparent;
            backdrop-filter: none;
            border: none;
            transition: all 0.3s ease;
        }

        .category-card:hover {
            background: transparent;
        }

        .category-content {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            border: none;
        }

        .category-content:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .avatar-img {
            width: 200px;
            height: 200px;
            border-radius: 0;
            object-fit: cover;
            border: none;
            background: linear-gradient(135deg, #ff006e, #8338ec) border-box;
            transition: all 0.3s ease;
        }

        .selection-button {
            width: 100%;
            margin-top: 1rem;
            transition: all 0.3s ease;
        }

        .selection-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 20px rgba(255, 0, 110, 0.4);
        }

        .slide-in {
            animation: slideIn 0.4s ease-out forwards;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .icon-float {
            animation: iconFloat 2s ease-in-out infinite;
        }

        @keyframes iconFloat {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(5deg); }
        }

        .vote-btn {
            background: linear-gradient(135deg, #ff006e, #8338ec);
            transition: all 0.3s ease;
        }

        .vote-btn:hover:not(:disabled) {
            box-shadow: 0 0 30px rgba(255, 0, 110, 0.6);
            transform: scale(1.05);
        }

        .vote-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .chevron {
            transition: transform 0.3s ease;
        }

        .chevron.open {
            transform: rotate(180deg);
        }

        .admin-panel {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
        }

        .result-bar {
            background: linear-gradient(135deg, #ff006e, #8338ec);
            transition: width 1s ease-out;
        }

        .modal {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
        }

        .winner-glow {
            animation: winnerGlow 2s ease-in-out infinite;
        }

        @keyframes winnerGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.5); }
            50% { box-shadow: 0 0 40px rgba(255, 215, 0, 0.8), 0 0 60px rgba(255, 0, 110, 0.4); }
        }

        .pig-with-crown {
            position: relative;
            display: inline-block;
            font-size: 1em;
        }

        .crown-on-pig {
            position: absolute;
            top: -0.3em;
            left: 0.2em;
            transform: rotate(-15deg);
            font-size: 0.6em;
            z-index: 1;
        }
    </style>
</head>
<body class="text-white overflow-x-hidden">
    <!-- Interactive Grid Background -->
    <canvas id="gridCanvas"></canvas>

    <!-- Stars Background -->
    <div id="stars" class="fixed inset-0 pointer-events-none"></div>

    <!-- Admin Button (hidden in corner) -->
    <button onclick="showAdminLogin()" class="fixed bottom-4 right-4 w-10 h-10 rounded-full bg-gray-800/50 hover:bg-gray-700/50 text-gray-500 hover:text-white transition-all text-xs z-50">
        ‚öôÔ∏è
    </button>

        <!-- Header -->
        <header class="relative py-8 text-center">
            <div class="floating inline-block">
                <h1 class="text-5xl md:text-7xl font-black">
                    <span class="glow-text text-pink-500">SLAY</span>
                    <span class="glow-purple text-purple-500 relative inline-block">
                        <span class="pig-with-crown">üê∑</span>
                        <span class="crown-on-pig">üëë</span>
                    </span>
                    <span class="glow-purple text-purple-500"> SVING</span>
                </h1>
            </div>
            <p class="mt-4 text-xl text-gray-400 tracking-widest">‚ú® –ò–¢–û–ì–ò –ì–û–î–ê 2026 ‚ú®</p>
            <div class="mt-6 flex justify-center gap-4 flex-wrap px-4">
                <span class="px-4 py-2 rounded-full bg-pink-500/20 text-pink-400 text-sm">üî• –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ</span>
                <span id="progressBadge" class="px-4 py-2 rounded-full bg-purple-500/20 text-purple-400 text-sm">üìä –ü—Ä–æ–≥—Ä–µ—Å—Å: 0/6</span>
            </div>
        </header>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto px-4 pb-20">
        <!-- Loading State -->
        <div id="loadingState" class="text-center py-20">
            <div class="text-4xl mb-4 animate-spin">‚è≥</div>
            <p class="text-gray-400">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
        </div>

        <!-- Categories Container -->
        <div id="categoriesContainer" class="space-y-12 hidden">
            <!-- Categories will be generated by JS -->
        </div>


        <!-- Thank You Message -->
        <div id="thankYouMessage" class="hidden text-center mt-12">
            <div class="gradient-border inline-block">
                <div class="bg-gray-900 rounded-3xl p-8 md:p-12">
                    <div class="text-6xl mb-4">üéâ</div>
                    <h2 class="text-3xl md:text-4xl font-bold glow-text mb-4">–°–ø–∞—Å–∏–±–æ –∑–∞ —É—á–∞—Å—Ç–∏–µ!</h2>
                    <p class="text-gray-400 text-lg">–í–∞—à –≥–æ–ª–æ—Å —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω.<br>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –æ–±—ä—è–≤–ª–µ–Ω—ã –ø–æ–∑–∂–µ!</p>
                    <div class="mt-6 text-4xl">üíñ‚ú®üèÜ</div>
                </div>
            </div>
        </div>

    </main>


        <!-- Admin Login Modal -->
        <div id="adminLoginModal" class="modal fixed inset-0 z-50 hidden flex items-center justify-center p-4">
            <div class="bg-gray-900 rounded-3xl p-8 max-w-md w-full border border-gray-700">
                <h2 class="text-2xl font-bold mb-6 text-center">üîê –í—Ö–æ–¥ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
                <input type="password" id="adminPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" 
                    class="w-full px-4 py-3 rounded-xl bg-gray-800 border border-gray-700 text-white mb-4 focus:border-pink-500 focus:outline-none">
                <div class="flex gap-4">
                    <button onclick="closeAdminLogin()" class="flex-1 px-6 py-3 rounded-xl bg-gray-700 hover:bg-gray-600 transition">–û—Ç–º–µ–Ω–∞</button>
                    <button onclick="checkAdminPassword()" class="flex-1 px-6 py-3 rounded-xl gradient-btn font-semibold">–í–æ–π—Ç–∏</button>
                </div>
                <p id="adminError" class="text-red-500 text-center mt-4 hidden">–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!</p>
            </div>
        </div>

    <!-- Admin Panel Modal -->
    <div id="adminPanel" class="admin-panel fixed inset-0 z-50 hidden overflow-y-auto">
        <div class="min-h-screen p-4 md:p-8">
            <div class="max-w-4xl mx-auto">
                <div class="flex justify-between items-center mb-8">
                    <h2 class="text-3xl font-bold glow-text">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è</h2>
                    <button onclick="closeAdminPanel()" class="px-4 py-2 rounded-xl bg-gray-700 hover:bg-gray-600 transition">‚úï –ó–∞–∫—Ä—ã—Ç—å</button>
                </div>
                
                <div id="resultsContainer" class="space-y-8">
                    <!-- Results will be generated by JS -->
                </div>

                <div class="mt-8 p-6 rounded-2xl bg-gray-800/50 border border-gray-700">
                    <h3 class="text-xl font-bold mb-4">üìà –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                    <p class="text-gray-400">–í—Å–µ–≥–æ –ø—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞–ª–æ: <span id="totalVoters" class="text-white font-bold">0</span> —á–µ–ª–æ–≤–µ–∫</p>
                </div>

                <div class="mt-6 p-6 rounded-2xl bg-red-900/20 border border-red-900/30">
                    <h3 class="text-xl font-bold mb-4 text-red-400">‚ö†Ô∏è –û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞</h3>
                    <button onclick="clearAllVotes()" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-xl transition">
                        üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –≥–æ–ª–æ—Å–∞
                    </button>
                    <p class="text-red-400 text-sm mt-2 text-center">–≠—Ç—É –æ–ø–µ—Ä–∞—Ü–∏—é –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Thank You Modal -->
    <div id="thankYouModal" class="modal-overlay">
        <div class="nominee-modal">
            <div class="modal-header">
                <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-bold text-white">üéâ –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –≥–æ–ª–æ—Å!</h2>
                    <button onclick="closeThankYouModal()" class="text-3xl text-gray-400 hover:text-white transition">√ó</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="text-center space-y-4">
                    <div class="text-6xl">üíñ</div>
                    <h3 class="text-xl font-bold">–í–∞—à –≥–æ–ª–æ—Å —É—Å–ø–µ—à–Ω–æ —É—á—Ç—ë–Ω!</h3>
                    <p class="text-gray-300">–í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –≤ –¥—Ä—É–≥–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö.</p>

                    <div class="mt-6 p-4 rounded-xl bg-purple-500/10 border border-purple-500/30">
                        <p class="text-purple-400 font-medium mb-3">üì¢ –ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ Telegram –∫–∞–Ω–∞–ª —Å–æ–∑–¥–∞—Ç–µ–ª—è:</p>
                        <a href="https://t.me/Mapi4kaa" target="_blank" class="text-pink-400 hover:text-pink-300 font-bold text-lg underline">
                            üîó @Mapi4kaa
                        </a>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="flex justify-center items-center w-full">
                    <button onclick="closeThankYouModal()" class="gradient-btn px-12 py-3 rounded-full text-lg font-semibold">
                        ‚úÖ –ü–æ–Ω—è—Ç–Ω–æ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Nominees Selection Modal -->
    <div id="nomineesModal" class="modal-overlay">
        <div class="nominee-modal">
            <div class="modal-header">
                <div class="flex justify-between items-center">
                    <h2 id="modalCategoryName" class="text-2xl font-bold text-white"></h2>
                    <button onclick="closeNomineesModal()" class="text-3xl text-gray-400 hover:text-white transition">√ó</button>
                </div>
                <p id="modalCategoryQuestion" class="text-gray-300 mt-2"></p>
            </div>
            <div class="modal-body">
                <div id="modalNomineesContainer" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"></div>
            </div>
            <div class="modal-footer">
                <div class="flex justify-between items-center">
                    <button onclick="closeNomineesModal()" class="px-6 py-2 rounded-full bg-gray-700 hover:bg-gray-600 transition">–û—Ç–º–µ–Ω–∞</button>
                    <button id="modalConfirmBtn" onclick="confirmModalSelection()" class="px-8 py-2 rounded-full vote-btn font-semibold" disabled>üöÄ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≥–æ–ª–æ—Å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="text-center py-8 text-gray-500 relative">
        <div class="absolute bottom-0 left-0 right-0 h-4 bg-gradient-to-t from-black/50 to-transparent backdrop-blur-sm"></div>
        <div class="relative z-10">
            <p>Made with üíñ by <span class="text-pink-400 font-semibold">Mandlail</span></p>
            <p class="text-sm mt-2">¬© 2026 –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã</p>
        </div>
    </footer>

    <!-- Bottom Blur Effect -->
    <div class="fixed bottom-0 left-0 right-0 h-16 bg-gradient-to-t from-black/80 to-transparent backdrop-blur-lg z-40"></div>

    <script>
        // =====================================================
        // ‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ò - –ò–ó–ú–ï–ù–ò –≠–¢–û –ü–û–î –°–ï–ë–Ø!
        // =====================================================

        // üîë –ü–∞—Ä–æ–ª—å –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ (–ø–æ–º–µ–Ω—è–π –Ω–∞ —Å–≤–æ–π!)
        const ADMIN_PASSWORD = 'slay2026admin';

        // üóÑÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ API
        const API_BASE_URL = ''; // –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        
        // üë• –ù–û–ú–ò–ù–ê–ù–¢–´ - –î–û–ë–ê–í–¨ –°–í–û–ò–• –õ–Æ–î–ï–ô –ò –ò–• –§–û–¢–û!
        // –î–ª—è —Ñ–æ—Ç–æ –º–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
        // - –°—Å—ã–ª–∫–∏ –Ω–∞ —Ñ–æ—Ç–æ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
        // - –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ –Ω–∞ imgur.com –∏ –≤—Å—Ç–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É
        // - –ò–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å photo: null –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–µ—Ä–≤–æ–π –±—É–∫–≤—ã –∏–º–µ–Ω–∏
        
        const categories = [
            {
                id: 'person_of_year',
                name: '–ß–µ–ª–æ–≤–µ–∫ –ì–æ–¥–∞',
                icon: 'üëë',
                question: '–ö—Ç–æ –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –∑–≤–∞–Ω–∏–µ –ß–µ–ª–æ–≤–µ–∫–∞ –ì–æ–¥–∞?',
                nominees: [
                    { id: 1, name: '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä', photo: 'https://koldunov.com/wp-content/uploads/2021/03/06.jpg' },  // null = –ø–æ–∫–∞–∂–µ—Ç –±—É–∫–≤—É "–ê"
                    { id: 2, name: '–ú–∞—Ä–∏—è', photo: null },
                    { id: 3, name: '–î–º–∏—Ç—Ä–∏–π', photo: null },
                    { id: 4, name: '–ê–Ω–Ω–∞', photo: null },
                    { id: 5, name: '–ù–∏–∫–∏—Ç–∞', photo: null },
                    { id: 6, name: '–°–æ—Ñ–∏—è', photo: null }
                    // –î–æ–±–∞–≤—å –±–æ–ª—å—à–µ –ª—é–¥–µ–π –∏–ª–∏ —É–¥–∞–ª–∏ –ª–∏—à–Ω–∏—Ö!
                ]
            },
            {
                id: 'style_icon',
                name: '–ò–∫–æ–Ω–∞ –°—Ç–∏–ª—è',
                icon: 'üíÖ',
                question: '–ö—Ç–æ –æ–¥–µ–≤–∞–µ—Ç—Å—è –ª—É—á—à–µ –≤—Å–µ—Ö?',
                nominees: [
                    { id: 1, name: '–í–∏–∫—Ç–æ—Ä–∏—è', photo: null },
                    { id: 2, name: '–ú–∞–∫—Å–∏–º', photo: null },
                    { id: 3, name: '–ï–ª–µ–Ω–∞', photo: null },
                    { id: 4, name: '–ê—Ä—Ç—ë–º', photo: null },
                    { id: 5, name: '–ü–æ–ª–∏–Ω–∞', photo: null },
                    { id: 6, name: '–î–∞–Ω–∏–∏–ª', photo: null }
                ]
            },
            {
                id: 'party_soul',
                name: '–î—É—à–∞ –ö–æ–º–ø–∞–Ω–∏–∏',
                icon: 'üéâ',
                question: '–° –∫–µ–º –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—ã–≤–∞–µ—Ç —Å–∫—É—á–Ω–æ?',
                nominees: [
                    { id: 1, name: '–ö–∏—Ä–∏–ª–ª', photo: null },
                    { id: 2, name: '–ê–ª–∏—Å–∞', photo: null },
                    { id: 3, name: '–ò–≤–∞–Ω', photo: null },
                    { id: 4, name: '–î–∞—Ä—å—è', photo: null },
                    { id: 5, name: '–ï–≥–æ—Ä', photo: null },
                    { id: 6, name: '–ö—Å–µ–Ω–∏—è', photo: null }
                ]
            },
            {
                id: 'best_friend',
                name: '–õ—É—á—à–∏–π –î—Ä—É–≥',
                icon: 'üíï',
                question: '–ù–∞ –∫–æ–≥–æ –≤—Å–µ–≥–¥–∞ –º–æ–∂–Ω–æ –ø–æ–ª–æ–∂–∏—Ç—å—Å—è?',
                nominees: [
                    { id: 1, name: '–ê–Ω–¥—Ä–µ–π', photo: null },
                    { id: 2, name: '–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞', photo: null },
                    { id: 3, name: '–ú–∏—Ö–∞–∏–ª', photo: null },
                    { id: 4, name: '–û–ª—å–≥–∞', photo: null },
                    { id: 5, name: '–°–µ—Ä–≥–µ–π', photo: null },
                    { id: 6, name: '–¢–∞—Ç—å—è–Ω–∞', photo: null }
                ]
            },
            {
                id: 'funniest',
                name: '–°–∞–º—ã–π –°–º–µ—à–Ω–æ–π',
                icon: 'üòÇ',
                question: '–ö—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –≤—Å–µ—Ö —Å–º–µ—è—Ç—å—Å—è?',
                nominees: [
                    { id: 1, name: '–î–µ–Ω–∏—Å', photo: null },
                    { id: 2, name: '–Æ–ª–∏—è', photo: null },
                    { id: 3, name: '–ü–∞–≤–µ–ª', photo: null },
                    { id: 4, name: '–ù–∞—Ç–∞–ª—å—è', photo: null },
                    { id: 5, name: '–†–æ–º–∞–Ω', photo: null },
                    { id: 6, name: '–í–µ—Ä–æ–Ω–∏–∫–∞', photo: null }
                ]
            },
            {
                id: 'talent',
                name: '–°–∞–º—ã–π –¢–∞–ª–∞–Ω—Ç–ª–∏–≤—ã–π',
                icon: 'üé®',
                question: '–ö—Ç–æ –æ–±–ª–∞–¥–∞–µ—Ç –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω—ã–º —Ç–∞–ª–∞–Ω—Ç–æ–º?',
                nominees: [
                    { id: 1, name: '–ê–ª–µ–∫—Å–µ–π', photo: null },
                    { id: 2, name: '–ú–∞—Ä–∏–Ω–∞', photo: null },
                    { id: 3, name: '–í–ª–∞–¥–∏—Å–ª–∞–≤', photo: null },
                    { id: 4, name: '–ê–Ω–∞—Å—Ç–∞—Å–∏—è', photo: null },
                    { id: 5, name: '–ì–ª–µ–±', photo: null },
                    { id: 6, name: '–í–∞–ª–µ—Ä–∏—è', photo: null }
                ]
            }
        ];
        
        // =====================================================
        // üîß –ö–û–î –°–ê–ô–¢–ê (–Ω–µ –º–µ–Ω—è–π –µ—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—à—å —á—Ç–æ –¥–µ–ª–∞–µ—à—å)
        // =====================================================

        let openCategory = null;
        let selectedNominees = {};
        let hasSubmitted = false;
        let voterId = localStorage.getItem('slaySvingVoterId');

        // Generate unique voter ID
        if (!voterId) {
            voterId = 'voter_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            localStorage.setItem('slaySvingVoterId', voterId);
        }

        // API Helper Functions
        async function apiRequest(endpoint, method = 'GET', data = null) {
            try {
                const url = API_BASE_URL + endpoint;
                const options = {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json'
                    }
                };

                if (data) {
                    options.body = JSON.stringify(data);
                }

                const response = await fetch(url, options);

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                return await response.json();
            } catch (error) {
                console.error('API request failed:', error);
                throw error;
            }
        }

        // Check if user already voted
        async function checkIfVoted() {
            // Always check localStorage first
            if (localStorage.getItem('slaySvingSubmitted') === 'true') {
                hasSubmitted = true;
                return;
            }

            try {
                const response = await apiRequest('/api/check-voted', 'POST', { voter_id: voterId });
                if (response.success && response.hasVoted) {
                    hasSubmitted = true;
                    localStorage.setItem('slaySvingSubmitted', 'true');
                }
            } catch (error) {
                console.log('Vote check failed, using localStorage only:', error);
                // Continue with localStorage only if API fails
            }
        }

        // Load user's current votes
        async function loadUserVotes() {
            try {
                const response = await apiRequest(`/api/vote/${voterId}`, 'GET');
                if (response.success && response.vote) {
                    selectedNominees = response.vote.votes;
                    return true;
                }
            } catch (error) {
                console.log('Error loading user votes:', error);
            }
            return false;
        }

        // Reset voting state
        function resetVotingState() {
            hasSubmitted = false;
            localStorage.removeItem('slaySvingSubmitted');
            selectedNominees = {};
        }


        // Initialize stars
        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 80; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 2 + 's';
                star.style.width = Math.random() * 3 + 2 + 'px';
                star.style.height = star.style.width;
                starsContainer.appendChild(star);
            }
        }

        // Initialize snow
        function createSnow() {
            const snowContainer = document.createElement('div');
            snowContainer.id = 'snow';
            snowContainer.className = 'fixed inset-0 pointer-events-none';
            document.body.appendChild(snowContainer);

            // Add CSS animation for snowfall
            const style = document.createElement('style');
            style.textContent = `
                @keyframes fall {
                    0% { transform: translateY(-10px) rotate(0deg); }
                    100% { transform: translateY(100vh) rotate(360deg); }
                }
            `;
            document.head.appendChild(style);

            for (let i = 0; i < 150; i++) {
                const snowflake = document.createElement('div');
                snowflake.className = 'snowflake';
                snowflake.style.cssText = `
                    position: absolute;
                    left: ${Math.random() * 100}%;
                    top: -10px;
                    width: ${Math.random() * 4 + 2}px;
                    height: ${Math.random() * 4 + 2}px;
                    background: white;
                    border-radius: 50%;
                    opacity: ${Math.random() * 0.8 + 0.2};
                    animation: fall ${Math.random() * 5 + 3}s linear infinite;
                    animation-delay: ${Math.random() * 5}s;
                    z-index: 1000;
                `;
                snowContainer.appendChild(snowflake);
            }
        }

    // Get avatar HTML
    function getAvatarHTML(nominee, size = 60) {
        if (nominee.photo) {
            return `<img src="${nominee.photo}" alt="${nominee.name}" class="avatar-img avatar-glow" style="width:${size}px;height:${size}px;">`;
        } else {
            return `<div class="avatar-placeholder avatar-glow" style="width:${size}px;height:${size}px;">${nominee.name.charAt(0)}</div>`;
        }
    }

        // Update progress
        function updateProgress() {
            const votedCount = Object.keys(selectedNominees).length;
            document.getElementById('progressBadge').textContent = `üìä –ü—Ä–æ–≥—Ä–µ—Å—Å: ${votedCount}/${categories.length}`;
        }

        // Render all categories
        async function renderCategories() {
            document.getElementById('loadingState').classList.add('hidden');

            // Load user's votes if they exist
            await loadUserVotes();

            const container = document.getElementById('categoriesContainer');
            container.classList.remove('hidden');

            container.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-12">
                    ${categories.map((category, index) => {
                        const votedFor = selectedNominees[category.id];
                        const votedNominee = votedFor ? category.nominees.find(n => n.id === votedFor) : null;

                        return `
                            <div class="category-card slide-in" style="animation-delay: ${index * 0.1}s">
                                <!-- New Separated Design: Category Name and Button are separate -->
                                <div class="flex flex-col items-center gap-4">
                                    <div class="category-content">
                                        ${votedFor ?
                                            `<div class="flex flex-col items-center gap-2">
                                                ${getAvatarHTML(votedNominee, 200)}
                                            </div>` :
                                            `<div class="flex flex-col items-center gap-2">
                                                <div class="w-36 h-40 bg-gray-600 rounded-t-full flex items-end justify-center overflow-hidden">
                                                    <div class="w-28 h-32 bg-gray-700 rounded-t-full"></div>
                                                </div>
                                            </div>`}
                                    </div>
                                    <h3 class="category-name">${category.name}</h3>
                                    <button onclick="openNomineesModal('${category.id}')" 
                                        class="select-btn selection-button px-6 py-2 rounded-full font-semibold text-sm">
                                        ${votedFor ? 'üîÑ –ò–∑–º–µ–Ω–∏—Ç—å –≤—ã–±–æ—Ä' : '‚ú® –°–¥–µ–ª–∞—Ç—å –≤—ã–±–æ—Ä'}
                                    </button>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;

            updateProgress();
        }

        // Open nominees modal
        let currentModalCategory = null;

        function openNomineesModal(categoryId) {
            currentModalCategory = categoryId;
            const category = categories.find(c => c.id === categoryId);
            const modal = document.getElementById('nomineesModal');
            const container = document.getElementById('modalNomineesContainer');

            // Set modal title and question
            document.getElementById('modalCategoryName').textContent = category.icon + ' ' + category.name;
            document.getElementById('modalCategoryQuestion').textContent = category.question;

            // Render nominees
            container.innerHTML = category.nominees.map(nominee => {
                const isSelected = selectedNominees[categoryId] === nominee.id;
                return `
                    <div class="nominee-card rounded-xl p-3 cursor-pointer ${isSelected ? 'selected' : ''}"
                        onclick="selectModalNominee('${categoryId}', ${nominee.id})">
                        <div class="flex flex-col items-center gap-2">
                            ${getAvatarHTML(nominee, 80)}
                            <h3 class="font-bold text-white text-sm mt-2">${nominee.name}</h3>
                            <button class="select-btn mt-2 px-4 py-2 rounded-full text-sm font-semibold">
                                ${isSelected ? '‚úì –í—ã–±—Ä–∞–Ω' : '–í—ã–±—Ä–∞—Ç—å'}
                            </button>
                        </div>
                    </div>
                `;
            }).join('');

            // Update confirm button state
            const confirmBtn = document.getElementById('modalConfirmBtn');
            confirmBtn.disabled = !selectedNominees[categoryId];

            // Show modal
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Close nominees modal
        function closeNomineesModal() {
            const modal = document.getElementById('nomineesModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        // Select nominee in modal
        function selectModalNominee(categoryId, nomineeId) {
            selectedNominees[categoryId] = nomineeId;

            // Update UI in modal
            const cards = document.querySelectorAll('#modalNomineesContainer .nominee-card');
            cards.forEach(card => {
                card.classList.remove('selected');
                const button = card.querySelector('button');
                button.textContent = '–í—ã–±—Ä–∞—Ç—å';
                button.classList.remove('voted');
            });

            const selectedCard = document.querySelector(`#modalNomineesContainer .nominee-card:nth-child(${nomineeId})`);
            if (selectedCard) {
                selectedCard.classList.add('selected');
                const button = selectedCard.querySelector('button');
                button.textContent = '‚úì –í—ã–±—Ä–∞–Ω';
                button.classList.add('voted');
            }

            // Enable confirm button
            document.getElementById('modalConfirmBtn').disabled = false;
        }

        // Confirm selection in modal
        async function confirmModalSelection() {
            if (!currentModalCategory || !selectedNominees[currentModalCategory]) return;

            // Prepare votes data
            const votesData = {
                voter_id: voterId,
                votes: selectedNominees,
                created_at: new Date().toISOString()
            };

            try {
                // Save to local API
                const response = await apiRequest('/api/vote', 'POST', votesData);

                if (!response.success) {
                    if (response.error && response.error.includes('—É–∂–µ –≥–æ–ª–æ—Å–æ–≤–∞–ª–∏')) {
                        alert('‚ö†Ô∏è –í—ã —É–∂–µ –≥–æ–ª–æ—Å–æ–≤–∞–ª–∏ —Å —ç—Ç–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞. –ö–∞–∂–¥—ã–π –º–æ–∂–µ—Ç –ø—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑!');
                    } else {
                        throw new Error('API error');
                    }
                    return;
                }

                // Don't mark as submitted yet - allow voting in multiple categories
                createConfetti(50);

                // Show thank you modal instead of completing voting
                showThankYouModal();

                setTimeout(() => {
                    closeNomineesModal();
                    renderCategories();
                }, 500);
            } catch (error) {
                console.error('Error saving vote:', error);
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.');
            }
        }

        // Show thank you modal
        function showThankYouModal() {
            const modal = document.getElementById('thankYouModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Close thank you modal
        function closeThankYouModal() {
            const modal = document.getElementById('thankYouModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        // Clear all votes function
        async function clearAllVotes() {
            const password = prompt('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –≤—Å–µ—Ö –≥–æ–ª–æ—Å–æ–≤:');
            if (!password) return;

            try {
                const response = await apiRequest('/api/admin/clear-votes', 'POST', { password });

                if (response.success) {
                    alert('‚úÖ –í—Å–µ –≥–æ–ª–æ—Å–∞ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ IP —É—Å–ø–µ—à–Ω–æ –æ—á–∏—â–µ–Ω—ã!');
                    // Refresh results
                    await loadResults();
                } else {
                    alert('‚ùå –û—à–∏–±–∫–∞: ' + (response.error || '–ù–µ —É–¥–∞–ª–æ—Å—å –æ—á–∏—Å—Ç–∏—Ç—å –≥–æ–ª–æ—Å–∞'));
                }
            } catch (error) {
                console.error('Error clearing votes:', error);
                alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ –≥–æ–ª–æ—Å–æ–≤. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–æ–ª—å –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
            }
        }

        // Submit all votes
        async function submitAllVotes() {
            if (Object.keys(selectedNominees).length < categories.length) return;

            const submitBtn = document.getElementById('submitAllBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = '‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞...';

            // Prepare votes data
            const votesData = {
                voter_id: voterId,
                votes: selectedNominees,
                created_at: new Date().toISOString()
            };

            try {
                // Save to local API
                const response = await apiRequest('/api/vote', 'POST', votesData);

                if (!response.success) {
                    if (response.error && response.error.includes('—É–∂–µ –≥–æ–ª–æ—Å–æ–≤–∞–ª–∏')) {
                        alert('‚ö†Ô∏è –í—ã —É–∂–µ –≥–æ–ª–æ—Å–æ–≤–∞–ª–∏ —Å —ç—Ç–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞. –ö–∞–∂–¥—ã–π –º–æ–∂–µ—Ç –ø—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑!');
                    } else {
                        throw new Error('API error');
                    }
                    return;
                }

                localStorage.setItem('slaySvingSubmitted', 'true');
                hasSubmitted = true;

                createConfetti(100);

                setTimeout(() => {
                    renderCategories();
                }, 500);
            } catch (error) {
                console.error('Error saving vote:', error);
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.');
                submitBtn.disabled = false;
                submitBtn.textContent = 'üöÄ –û–¢–ü–†–ê–í–ò–¢–¨ –í–°–ï –ì–û–õ–û–°–ê';
            }
        }

        // Admin functions
        function showAdminLogin() {
            document.getElementById('adminLoginModal').classList.remove('hidden');
            document.getElementById('adminPassword').value = '';
            document.getElementById('adminError').classList.add('hidden');
        }

        function closeAdminLogin() {
            document.getElementById('adminLoginModal').classList.add('hidden');
        }

        async function checkAdminPassword() {
            const password = document.getElementById('adminPassword').value;

            try {
                const response = await apiRequest('/api/admin/check-password', 'POST', { password });

                if (response.success && response.isValid) {
                    closeAdminLogin();
                    showAdminPanel();
                } else {
                    document.getElementById('adminError').classList.remove('hidden');
                }
            } catch (error) {
                console.error('Admin password check failed:', error);
                document.getElementById('adminError').classList.remove('hidden');
            }
        }

        async function showAdminPanel() {
            document.getElementById('adminPanel').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            await loadResults();
        }

        function closeAdminPanel() {
            document.getElementById('adminPanel').classList.add('hidden');
            document.body.style.overflow = '';
        }

        async function loadResults() {
            try {
                const response = await apiRequest('/api/votes', 'GET');
                let allVotes = [];

                if (response.success && response.votes) {
                    allVotes = response.votes;
                }

                document.getElementById('totalVoters').textContent = allVotes.length;

                const resultsContainer = document.getElementById('resultsContainer');

                resultsContainer.innerHTML = categories.map(category => {
                    // Count votes for each nominee
                    const voteCounts = {};
                    category.nominees.forEach(n => voteCounts[n.id] = 0);

                    allVotes.forEach(vote => {
                        const nomineeId = vote.votes[category.id];
                        if (nomineeId && voteCounts[nomineeId] !== undefined) {
                            voteCounts[nomineeId]++;
                        }
                    });

                    // Sort by votes
                    const sortedNominees = [...category.nominees].sort((a, b) => voteCounts[b.id] - voteCounts[a.id]);
                    const maxVotes = Math.max(...Object.values(voteCounts), 1);
                    const totalVotesInCategory = Object.values(voteCounts).reduce((a, b) => a + b, 0);

                    // Find winner
                    const winner = sortedNominees[0];
                    const winnerVotes = voteCounts[winner.id];
                    const hasWinner = winnerVotes > 0;

                    return `
                        <div class="bg-gray-800/50 rounded-2xl p-6 border border-gray-700">
                            <div class="flex items-center gap-3 mb-6">
                                <span class="text-4xl">${category.icon}</span>
                                <h3 class="text-xl font-bold">${category.name}</h3>
                            </div>

                            ${hasWinner ? `
                            <div class="mb-6 p-4 rounded-xl bg-yellow-500/10 border border-yellow-500/30 winner-glow">
                                <div class="flex items-center gap-4">
                                    <div class="text-6xl">üèÜ</div>
                                    <div>
                                        <h4 class="text-2xl font-bold text-yellow-400">üéâ –ü–û–ë–ï–î–ò–¢–ï–õ–¨!</h4>
                                        <div class="flex items-center gap-3 mt-2">
                                            ${getAvatarHTML(winner, 50)}
                                            <span class="text-xl font-bold text-white">${winner.name}</span>
                                            <span class="text-yellow-400 font-bold">${winnerVotes} –≥–æ–ª–æ—Å–æ–≤</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            ` : ''}

                            <div class="space-y-4">
                                <h4 class="text-lg font-semibold text-gray-300 mb-3">üìä –ü–æ–ª–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</h4>
                                ${sortedNominees.map((nominee, index) => {
                                    const votes = voteCounts[nominee.id];
                                    const percentage = totalVotesInCategory > 0 ? Math.round((votes / totalVotesInCategory) * 100) : 0;
                                    const barWidth = maxVotes > 0 ? (votes / maxVotes) * 100 : 0;
                                    const isWinner = index === 0 && votes > 0;

                                    return `
                                        <div class="${isWinner ? 'winner-glow rounded-xl p-3 bg-yellow-500/10' : 'p-3'}">
                                            <div class="flex items-center gap-3 mb-2">
                                                ${index === 0 && votes > 0 ? '<span class="text-2xl">ü•á</span>' :
                                                  index === 1 && votes > 0 ? '<span class="text-2xl">ü•à</span>' :
                                                  index === 2 && votes > 0 ? '<span class="text-2xl">ü•â</span>' :
                                                  '<span class="w-8"></span>'}
                                                ${getAvatarHTML(nominee, 40)}
                                                <span class="font-semibold flex-1">${nominee.name}</span>
                                                <span class="text-pink-400 font-bold">${votes} –≥–æ–ª–æ—Å–æ–≤ (${percentage}%)</span>
                                            </div>
                                            <div class="h-3 bg-gray-700 rounded-full overflow-hidden">
                                                <div class="result-bar h-full rounded-full" style="width: ${barWidth}%"></div>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    `;
                }).join('');
            } catch (error) {
                console.error('Error loading results:', error);
                document.getElementById('resultsContainer').innerHTML = '<p class="text-red-500">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</p>';
            }
        }

        // Create confetti
        function createConfetti(count = 50) {
            const colors = ['#ff006e', '#8338ec', '#3a86ff', '#00f5a0', '#ffbe0b', '#fb5607'];
            for (let i = 0; i < count; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.cssText = `
                    left: ${Math.random() * 100}vw;
                    top: -10px;
                    width: ${Math.random() * 10 + 5}px;
                    height: ${Math.random() * 10 + 5}px;
                    background: ${colors[Math.floor(Math.random() * colors.length)]};
                    border-radius: ${Math.random() > 0.5 ? '50%' : '0'};
                `;
                document.body.appendChild(confetti);
                
                const animation = confetti.animate([
                    { transform: `translateY(0) rotate(0deg)`, opacity: 1 },
                    { transform: `translateY(100vh) rotate(${Math.random() * 720}deg)`, opacity: 0 }
                ], {
                    duration: Math.random() * 2000 + 2000,
                    easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
                });
                
                animation.onfinish = () => confetti.remove();
            }
        }

        // Handle Enter key in password field
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !document.getElementById('adminLoginModal').classList.contains('hidden')) {
                checkAdminPassword();
            }
        });

        // Keep-alive function for Render
        function setupKeepAlive() {
            // Ping server every 5 minutes to prevent sleep
            setInterval(() => {
                fetch('/keep-alive')
                    .then(response => response.json())
                    .then(data => {
                        console.log('Keep-alive:', data.message);
                    })
                    .catch(error => {
                        console.error('Keep-alive failed:', error);
                    });
            }, 300000); // 5 minutes

            // Also ping every minute for more frequent activity
            setInterval(() => {
                fetch('/ping')
                    .catch(error => {
                        console.error('Ping failed:', error);
                    });
            }, 60000); // 1 minute
        }

        // Interactive Grid Background with Pigs
        function initGridBackground() {
            const canvas = document.getElementById('gridCanvas');
            const ctx = canvas.getContext('2d');

            let width, height;
            let points = [];
            let mouse = { x: -1000, y: -1000 };
            const gridSize = 40;
            const influenceRadius = 200;

            // Load pig emoji as image
            const pigImage = new Image();
            pigImage.src = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZmlsbD0iI0ZGRkZGRiIgZD0iTTEyIDJDOC4xMyA2Ljg3IDUgMTIgMiAxMnptLTguMTMgMTRsLTEuNS0xLjVhLjUgLjUgMCAwIDAtLjUgLjV2MTRsLTEuNSAxLjVhLjUgLjUgMCAwIDAuNS0uNXYtMTR6bTAtMmMxLjEtMS4xIDItMiAyLTJzMiAxLjEgMiAyek0xMiA4YTUgNSAwIDAgMS01IDV2MTRoLTRhNSA1IDAgMCAxIDUgNXYtMTR6Ii8+PC9zdmc+';
            const crownImage = new Image();
            crownImage.src = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZmlsbD0iI0ZGRkZGRiIgZD0iTTEyIDJDOC4xMyA2Ljg3IDUgMTIgMiAxMnptLTguMTMgMTRsLTEuNS0xLjVhLjUgLjUgMCAwIDAtLjUgLjV2MTRsLTEuNSAxLjVhLjUgLjUgMCAwIDAuNS0uNXYtMTR6bTAtMmMxLjEtMS4xIDItMiAyLTJzMiAxLjEgMiAyek0xMiA4YTUgNSAwIDAgMS01IDV2MTRoLTRhNSA1IDAgMCAxIDUgNXYtMTR6Ii8+PC9zdmc+';

            function resize() {
                width = canvas.width = window.innerWidth;
                height = canvas.height = window.innerHeight;
                initGrid();
            }

            function initGrid() {
                points = [];
                const cols = Math.ceil(width / gridSize) + 1;
                const rows = Math.ceil(height / gridSize) + 1;

                for (let y = 0; y < rows; y++) {
                    for (let x = 0; x < cols; x++) {
                        points.push({
                            baseX: x * gridSize,
                            baseY: y * gridSize,
                            x: x * gridSize,
                            y: y * gridSize,
                            col: x,
                            row: y,
                            showPig: false,
                            pigOpacity: 0,
                            pigScale: 0
                        });
                    }
                }
            }

            function getPoint(col, row) {
                const cols = Math.ceil(width / gridSize) + 1;
                return points[row * cols + col];
            }

            function animate() {
                ctx.clearRect(0, 0, width, height);

                // Update points positions
                points.forEach(point => {
                    const dx = mouse.x - point.baseX;
                    const dy = mouse.y - point.baseY;
                    const distance = Math.sqrt(dx * dx + dy * dy);

                    if (distance < influenceRadius) {
                        const force = (1 - distance / influenceRadius) * 50;
                        const angle = Math.atan2(dy, dx);
                        point.x = point.baseX - Math.cos(angle) * force;
                        point.y = point.baseY - Math.sin(angle) * force;

                        // Show pig if close enough
                        if (distance < 50) {
                            point.showPig = true;
                            point.pigOpacity = Math.min(point.pigOpacity + 0.05, 0.8);
                            point.pigScale = Math.min(point.pigScale + 0.05, 1);
                        } else {
                            point.showPig = false;
                            point.pigOpacity = Math.max(point.pigOpacity - 0.02, 0);
                            point.pigScale = Math.max(point.pigScale - 0.02, 0);
                        }
                    } else {
                        point.x += (point.baseX - point.x) * 0.1;
                        point.y += (point.baseY - point.y) * 0.1;
                        point.showPig = false;
                        point.pigOpacity = Math.max(point.pigOpacity - 0.02, 0);
                        point.pigScale = Math.max(point.pigScale - 0.02, 0);
                    }
                });

                // Draw grid
                const cols = Math.ceil(width / gridSize) + 1;
                const rows = Math.ceil(height / gridSize) + 1;

                ctx.strokeStyle = 'rgba(100, 150, 255, 0.15)';
                ctx.lineWidth = 1;

                // Horizontal lines
                for (let row = 0; row < rows; row++) {
                    ctx.beginPath();
                    for (let col = 0; col < cols; col++) {
                        const point = getPoint(col, row);
                        if (col === 0) {
                            ctx.moveTo(point.x, point.y);
                        } else {
                            ctx.lineTo(point.x, point.y);
                        }
                    }
                    ctx.stroke();
                }

                // Vertical lines
                for (let col = 0; col < cols; col++) {
                    ctx.beginPath();
                    for (let row = 0; row < rows; row++) {
                        const point = getPoint(col, row);
                        if (row === 0) {
                            ctx.moveTo(point.x, point.y);
                        } else {
                            ctx.lineTo(point.x, point.y);
                        }
                    }
                    ctx.stroke();
                }

                // Draw pigs at special points using single emoji with crown
                // Clear previous emojis first to prevent stacking
                if (!document.getElementById('pigEmojiContainer')) {
                    const container = document.createElement('div');
                    container.id = 'pigEmojiContainer';
                    container.style.position = 'fixed';
                    container.style.top = '0';
                    container.style.left = '0';
                    container.style.width = '100%';
                    container.style.height = '100%';
                    container.style.pointerEvents = 'none';
                    container.style.zIndex = '100';
                    document.body.appendChild(container);
                } else {
                    // Clear all previous emojis to prevent stacking
                    document.getElementById('pigEmojiContainer').innerHTML = '';
                }

                points.forEach(point => {
                    if (point.pigOpacity > 0.1) {
                        // Create emoji element with normal size
                        const pigEmoji = document.createElement('div');
                        pigEmoji.innerHTML = 'üê∑'; // Simple pig emoji, normal size
                        pigEmoji.style.position = 'absolute';
                        pigEmoji.style.left = `${point.x}px`;
                        pigEmoji.style.top = `${point.y}px`;
                        pigEmoji.style.transform = `translate(-50%, -50%) scale(${point.pigScale})`;
                        pigEmoji.style.opacity = point.pigOpacity;
                        pigEmoji.style.fontSize = '24px'; // Normal size
                        pigEmoji.style.pointerEvents = 'none';
                        pigEmoji.style.zIndex = '100';
                        pigEmoji.style.transition = 'all 0.1s ease';
                        pigEmoji.style.color = 'rgba(255, 105, 180, 0.9)';

                        // Add subtle glow effect
                        pigEmoji.style.textShadow = '0 0 5px rgba(255, 215, 0, 0.3)';

                        document.getElementById('pigEmojiContainer').appendChild(pigEmoji);
                    }
                });

                // Highlight points near cursor
                points.forEach(point => {
                    const dx = mouse.x - point.x;
                    const dy = mouse.y - point.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);

                    if (distance < influenceRadius) {
                        const opacity = (1 - distance / influenceRadius) * 0.8;
                        const size = (1 - distance / influenceRadius) * 4 + 1;

                        ctx.beginPath();
                        ctx.arc(point.x, point.y, size, 0, Math.PI * 2);
                        ctx.fillStyle = `rgba(100, 200, 255, ${opacity})`;
                        ctx.fill();
                    }
                });

                // Glow around cursor
                const gradient = ctx.createRadialGradient(
                    mouse.x, mouse.y, 0,
                    mouse.x, mouse.y, influenceRadius
                );
                gradient.addColorStop(0, 'rgba(100, 150, 255, 0.1)');
                gradient.addColorStop(1, 'rgba(100, 150, 255, 0)');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, width, height);

                requestAnimationFrame(animate);
            }

            window.addEventListener('resize', resize);
            document.addEventListener('mousemove', (e) => {
                mouse.x = e.clientX;
                mouse.y = e.clientY;
            });

            document.addEventListener('mouseleave', () => {
                mouse.x = -1000;
                mouse.y = -1000;
            });

            resize();
            animate();
        }

        // Add subtle floating particles
        function createFloatingParticles() {
            const particleContainer = document.createElement('div');
            particleContainer.id = 'floatingParticles';
            particleContainer.className = 'fixed inset-0 pointer-events-none';
            document.body.appendChild(particleContainer);

            const colors = ['rgba(255, 0, 110, 0.1)', 'rgba(131, 56, 236, 0.1)', 'rgba(58, 134, 255, 0.1)'];

            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'floating-particle';
                particle.style.cssText = `
                    position: absolute;
                    left: ${Math.random() * 100}%;
                    top: ${Math.random() * 100}%;
                    width: ${Math.random() * 6 + 4}px;
                    height: ${Math.random() * 6 + 4}px;
                    background: ${colors[Math.floor(Math.random() * colors.length)]};
                    border-radius: 50%;
                    opacity: 0;
                    animation: floatParticle ${Math.random() * 15 + 10}s ease-in-out infinite;
                    animation-delay: ${Math.random() * 5}s;
                `;
                particleContainer.appendChild(particle);
            }

            // Add CSS animation for particles
            const style = document.createElement('style');
            style.textContent = `
                @keyframes floatParticle {
                    0%, 100% {
                        transform: translateY(0) rotate(0deg);
                        opacity: 0;
                    }
                    50% {
                        transform: translateY(-${Math.random() * 50 + 20}px) rotate(180deg);
                        opacity: 1;
                    }
                }
            `;
            document.head.appendChild(style);
        }

        // Add subtle pulse effect to header
        function addHeaderPulse() {
            const header = document.querySelector('header');
            if (header) {
                header.style.animation = 'headerPulse 8s ease-in-out infinite';
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes headerPulse {
                        0%, 100% { transform: scale(1); }
                        50% { transform: scale(1.01); }
                    }
                `;
                document.head.appendChild(style);
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initGridBackground();
            createStars();
            createSnow();
            createFloatingParticles();
            setupKeepAlive();

            // Add subtle header pulse after a delay
            setTimeout(addHeaderPulse, 1000);

            // Render immediately - don't wait for anything!
            if (localStorage.getItem('slaySvingSubmitted') === 'true') {
                hasSubmitted = true;
            }
            renderCategories();

            // Check if user already voted in background
            setTimeout(() => {
                checkIfVoted().then(() => {
                    if (hasSubmitted) {
                        renderCategories();
                    }
                }).catch(() => {});
            }, 100);
        });
    </script>
</body>
</html>
